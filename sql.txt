SELECT ZZ4_IDEQU,ZZ3_PLACA,ZZ3_FROTA,ZZ4_TIPMOV,MAX(ZZ4_DATMOV+ZZ4_HORMOV) FROM `ZZ4`
LEFT JOIN ZZ3 ON ZZ3_IDEQU=ZZ4_IDEQU
WHERE ZZ3_POSSE='2'
GROUP BY 1,2,3,4


SELECT 	ZZ3_IDEQU,
		ZZ3_PLACA,
		ZZ3_FROTA,
		(SELECT DZZ4_DATMOV FROM ZZ4 WHERE ZZ3_IDEQU=ZZ4_IDEQU) AND MAX(ZZ4_DATMOV) 
	FROM ZZ3 
	
SELECT 	ZZ3_IDEQU ID,
		(SELECT ZZ4_FILIAL FROM ZZ4 WHERE ZZ3_IDEQU=ZZ4_IDEQU ORDER BY ZZ4_DATMOV,ZZ4_HORMOV DESC LIMIT 1) FILIAL,
		ZZ3_PLACA PLACA,
		ZZ3_FROTA FROTA,
		(SELECT ZZ4_DATMOV FROM ZZ4 WHERE ZZ3_IDEQU=ZZ4_IDEQU ORDER BY ZZ4_DATMOV,ZZ4_HORMOV DESC LIMIT 1) DATA,
		(SELECT ZZ4_HORMOV FROM ZZ4 WHERE ZZ3_IDEQU=ZZ4_IDEQU ORDER BY ZZ4_DATMOV,ZZ4_HORMOV DESC LIMIT 1) HORA,
		(SELECT CASE
         		WHEN ZZ4_TIPMOV='1' THEN 'PATIO' 
         		ELSE 'TRANSITO' END 
         		FROM ZZ4 WHERE ZZ3_IDEQU=ZZ4_IDEQU ORDER BY ZZ4_DATMOV,ZZ4_HORMOV DESC LIMIT 1) STATUS
	FROM ZZ3_ ZZ3 WHERE ZZ3_EMPEQU LIKE '%LINAVE%'
	
	
SELECT 	ZZ4_IDEQU,
		ZZ4_FILAL,
		ZZ4_TIPMOV,
		ZZ4_DATMOV,
		ZZ4_HORMOV,
		ZZ4_STATUS
	FROM ZZ4 AS A
	INNER JOIN (SELECT B.ZZ4_IDEQU, MAX(ZZ4_DATMOV+ZZ4_HORMOV) MAXDAT 
					FROM ZZ4 AS B
					GROUP BY B.ZZ4_IDEQU) C ON C.MAXDAT = (A.ZZ4_DATMOV+A.ZZ4_HORMOV)
					
					

PARECE SER A MELHOR SELECT DE TODAS PARA APRESENTAR O RASTREAMENTO DE EQUIPAMENTOS

SELECT DISTINCT(Z4.ZZ4_IDEQU), Z4.ZZ4_PLACA, date_format(Z4.ZZ4_DATMOV,'%d/%m/%Y') ZZ4_DATMOV, ZZ4_HORMOV, (CASE WHEN ZZ4_TIPMOV = 1 THEN 'STOP' ELSE 'EM TRANSITO' END) AS STATUS, (CASE WHEN ZZ4_FILIAL = '0101' THEN 'BELEM' WHEN ZZ4_FILIAL = '0102' THEN 'MANAUS' WHEN ZZ4_FILIAL = '0103' THEN 'SANTAREM' WHEN ZZ4_FILIAL = '0104' THEN 'TROMBETAS' ELSE 'SEM FILIAL'END) FILIAL 
            FROM 
                ZZ4 Z4
            WHERE 
                Z4.ZZ4_DATMOV+Z4.ZZ4_HORMOV = (SELECT MAX(ZZ4_DATMOV+ZZ4_HORMOV) 
                                   FROM ZZ4 
                                   WHERE ZZ4_IDEQU = Z4.ZZ4_IDEQU 
                                   GROUP BY ZZ4_IDEQU)				
		